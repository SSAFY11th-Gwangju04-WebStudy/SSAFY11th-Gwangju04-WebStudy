# ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±ê³¼ì •

1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
- new AnnotationConfigApplication(AppConfig.class)
- appconfig.class êµ¬ì„±ì •ë³´ë¥¼ ë³´ê³  ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
- ìŠ¤í”„ë§ ë¹ˆ ì €ì¥ì†ŒëŠ” ë¹ˆì´ë¦„ê³¼ ë¹ˆê°ì²´ë¡œ êµ¬ì„± ë˜ì–´ ìˆë‹¤.

1. ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡
- Appconfingì— ìˆëŠ” í•¨ìˆ˜ë¥¼ ìƒì„±ì‹œ ëª¨ë“  í•¨ìˆ˜ë“¤ì„ í˜¸ì¶œí•œë‹¤.
- ë¹ˆì´ë¦„ : í´ë˜ìŠ¤ëª…
    - @Bean(name = â€œ â€œ ) ìœ¼ë¡œë„ ì§€ì •ê°€ëŠ¥
    - ì´ë¦„ì„ ë˜‘ê°™ì´ ì§€ì •í•  ì‹œ ë‹¤ë¥¸ë¹ˆì´ ë¬´ì‹œë˜ê±°ë‚˜ ê¸°ì¡´ë¹ˆì„ ë®ì–´ì“°ëŠ” ì˜¤ë¥˜ ë°œìƒ
    - **í•­ìƒ ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì§€ì •í•˜ì.**
- ë¹ˆ ê°ì²´ : return íƒ€ì…

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/cd4c5c0a-1563-4707-afa2-6b081ed69d45/9f2903f0-8c1e-426c-b16f-1e29f1ea43be/Untitled.png)

1.  ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì¤€ë¹„
- ìŠ¤í”„ë§ ë¹ˆ ë§Œë“¤ê¸°

1. ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì¤€ë¹„
- ê° ë¹ˆì˜ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…
- ë©¤ë²„ì„œë¹„ìŠ¤ëŠ” ë©¤ë²„ë¦¬íŒŒì§€í† ë¦¬ì™€ ì˜ì¡´ , ì˜¤ë”ì„œë¹„ìŠ¤ëŠ” í• ì¸ì •ì±…ê³¼ ,ë©¤ë²„ë¦¬íŒŒì§€í† ë¦¬ë¥¼ ì˜ì¡´

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/cd4c5c0a-1563-4707-afa2-6b081ed69d45/03012c0c-5023-4e65-a2d9-a92072475e80/Untitled.png)

ìŠ¤í”„ë§ì—ì„œëŠ” ë¹ˆ ë“±ë¡ê³¼ ì˜ì¡´ê´€ê³„ì£¼ì…ì´ ë‚˜ëˆ„ì–´ì ¸ìˆë‹¤. 

ìœ„ì˜ ì½”ë“œì²˜ëŸ¼ ë¹ˆ ìƒì„±í›„ ì˜ì¡´ê´€ê³„ë¥¼ ë°”ë¡œ ì£¼ì…í•˜ëŠ”ê²Œ ì•„ë‹ˆë‹¤.

# ë¹ˆ í™•ì¸

- ëª¨ë“  ë¹ˆ ì¶œë ¥í•˜ê¸°
- ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ ì¶œë ¥í•˜ê¸°

```jsx
    @Test
    @DisplayName("ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆì¶œë ¥")
    void  findApplicationBean() {
        String[] beanDefinitionNames = ac.getBeanDefinitionNames();
        for (String beanDefinitionName : beanDefinitionNames) {
            //getBeanDefiniation() :  ë¹ˆì˜ ì •ë³´
            BeanDefinition beanDefinition = ac.getBeanDefinition(beanDefinitionName);

            //ROLE_APPLICATION = ì§ì ‘ë“±ë¡í•œ ì• í”Œë ˆì¼€ì´ì…˜ ë¹ˆ
            //ROLE_INFRATSTURE = ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ
            if(beanDefinition.getRole()==BeanDefinition.ROLE_APPLICATION){
                Object bean = ac.getBean(beanDefinitionName);
                System.out.println("beanDefinitionName = " + beanDefinitionName+" object  = "  +bean);
            }
        }
    }
```

---

# ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ê¸°ë³¸

- ac.getBean(ë¹ˆì´ë¦„, íƒ€ì…)
- ac.getBean(íƒ€ì…)
- ì¡°íšŒ ëŒ€ìƒ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìœ¼ë©´ ì˜ˆì™¸ë°œìƒ
    - NoSuchBeanDefinitionException : No bean Named â€˜xxxxâ€™ availbale
- ì¡°íšŒ íƒ€ì…ì´ 2ê°œ ì´ìƒì¼ ë•Œ ì˜ˆì™¸ ë°œìƒ
    - NoUniqueBeanDefinitionException
- ìŠ¤í”„ë§ ë¹ˆ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ ë°©ë²•
    - Assertions.*assertThrows*(ì˜ˆì™¸ í´ë˜ìŠ¤, ì‹¤í–‰ ëŒë‹¤ í•¨ìˆ˜ );

```jsx
  @Test
    @DisplayName("ë¹ˆ íƒ€ì… 2ê°œì¼ë•Œ ì¡°íšŒ")
    void findBeanByType2() {

        Assertions.assertThrows(NoUniqueBeanDefinitionException.class, () -> ac.getBean(MemberRepository.class));
    }
    @Test
    @DisplayName("íŠ¹ì • íƒ€ì…ì„ ëª¨ë‘ ì¡°íšŒí•˜ê¸°")
    void findAllBeanType(){
        Map<String, MemberRepository> beansOfType = ac.getBeansOfType(MemberRepository.class);
        for (String key : beansOfType.keySet()) {
            System.out.println("key = " + key + " value = " + beansOfType.get(key));
        }
        System.out.println("beansOfType = " + beansOfType);
        assertThat(beansOfType.size()).isEqualTo(2);
    }
```

<aside>
ğŸ’¡ ì¦‰, ì¡°íšŒì‹œ ë¹ˆì´ë¦„ê³¼ ë¹ˆ ê°ì²´ íƒ€ì…ìœ¼ë¡œ ê²€ìƒ‰í•˜ì

</aside>

---

# ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ìƒì†ê´€ê³„

- ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ , ëª¨ë“  ìì‹íƒ€ì…ë„ ë‹¤ ì¡°íšŒëœë‹¤.
- object.classë¡œ ì¡°íšŒì‹œ ëª¨ë“  ë¹ˆë“¤ ì¶œë ¥ê°€ëŠ¥
- ì´ë¦„ìœ¼ë¡œ ì¡°íšŒí•˜ì

```jsx

    @Test
    @DisplayName("ë¶€ëª¨íƒ€ì… ì¡°íšŒì‹œ ìì‹ì´ ë‘˜ ì´ìƒì´ ìˆìœ¼ë©´ , ë¹ˆ ì´ë¦„ ë“±ë¡ ")
    void findBeanByParentTypeBeanName(){
        DiscountPolicy rateDiscountPolicy = ac.getBean("rateDiscountPolicy", DiscountPolicy.class);
        assertThat(rateDiscountPolicy).isInstanceOf(DiscountPolicy.class);
   }
```

# BeanFactory ì™€ applicationContext

---

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/cd4c5c0a-1563-4707-afa2-6b081ed69d45/714d51f2-7600-4872-afcc-ad9b206724b5/Untitled.png)

beanFactory 

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ìµœìƒìœ„ ì¸í„°í˜ì´ìŠ¤
- ìŠ¤í”„ë§ ë¹ˆì„ ê´€ë¦¬í•˜ê³  ì¡°íšŒí•˜ëŠ” ì—­í•  ë‹´ë‹¹
- .getBean() ì§€ê¸ˆê¹Œì§€ í–ˆë˜ ëŒ€ë¶€ë¶„ì˜ ê¸°ëŠ¥ì€ beanFactoryì˜ ê¸°ëŠ¥

applicationContext

- ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì‹œ ë¹ˆ ê´€ë¦¬,ì¡°íšŒ ê¸°ëŠ¥ì€ ë¬¼ë¡  ë§ì€ ë¶€ê°€ê¸°ëŠ¥ì´ í•„ìš”í•¨
    - messageSource : í•œêµ­ìœ¼ë¡œ ë“¤ì–´ì˜¤ë©´ í•œêµ­ì–´ , ì˜ì–´ê¶Œìœ¼ë¡œ ë“¤ì–´ì˜¤ë©´ ì˜ì–´ì¶œë ¥
    - environmentCapable : ë¡œì»¬, ê°œë°œ , ìš´ì˜ë“±ì„ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬
    - applicationEventPublisher : ì´ë²¤íŠ¸ ë°œí–‰ ë° êµ¬ë…í•˜ëŠ” ëª¨ë¸ì„ í¸ë¦¬í•˜ê²Œ ì§€ì›
    - resourceLoader : íŒŒì¼ í´ë˜ìŠ¤íŒ¨ìŠ¤ ì™¸ë¶€ ë“±ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ í¸ë¦¬í•˜ê²Œ ê´€ë¦¬

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/cd4c5c0a-1563-4707-afa2-6b081ed69d45/02bef5c5-604b-4909-a50a-964a14ee9273/Untitled.png)

### XML ì„¤ì • ì‚¬ìš©

- ì»´íŒŒì¼ ì—†ì´ ë¹ˆ ì„¤ì • ë³€ê²½í•  ìˆ˜ ìˆë”°.
- GenericXmlApplicationConText ì‚¬ìš©í•˜ë©´ì„œ xml ì„¤ì • íŒŒì¼ì„ ë„˜ê¸°ë©´ ëœë‹¤.

```jsx
@Configuration
public class AppConfig {
    @Bean
    public MemberService memberService() {

        return new MemberServiceImpl(getMemberRepository());
    }
    @Bean
    public static MemberRepository getMemberRepository() {
        return new MemoryMemberRepository();
    }
    @Bean
    public OrderService orderService() {
        return new OrderServiceImpl(getMemberRepository(), discountPolicy());
    }
    @Bean
    public DiscountPolicy discountPolicy(){
//        return new FixDiscountPolicy();
   return new RateDiscountPolicy();
    }
}

ìœ„ì˜ ì½”ë“œë¥¼ xml ì½”ë“œë¡œ ë³€ê²½
appconfig.xml

<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="memberService" class="hello.core.member.MemberServiceImpl">
        <constructor-arg name="memberRepository" ref="memberRepository">
        </constructor-arg>
    </bean>
    <bean id="memberRepository" class="hello.core.member.MemoryMemberRepository"/>

    <bean id ="orderService" class="hello.core.order.OrderServiceImpl">
    <constructor-arg name="memberRepository" ref="memberRepository"></constructor-arg>
        <constructor-arg name="discountPolicy" ref="discountPolicy"></constructor-arg>
    </bean>
    <bean id ="discountPolicy" class="hello.core.discount.RateDiscountPolicy"></bean>

</beans>
```

# BeanDefinition- ìŠ¤í”„ë§ ë¹ˆ ì„¤ì • ë©”íƒ€ ì •ë³´

- ìŠ¤í”„ë§ì€ BeanDefinitionì´ë¼ëŠ” ì¶”ìƒí™”ê°€ ìˆì–´ ë‹¤ì–‘í•œ ì„¤ì • í˜•ì‹ì„ ì§€ì›í•  ìˆ˜ ìˆë‹¤.
- ì—­í• ê³¼ êµ¬í˜„ì„ ê°œë…ì ìœ¼ë¡œ ë‚˜ëˆ  ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì˜¤ì§ beanDefininitionë§Œ ì•Œë©´ëœë‹¤.
- beanDefinitionì„ ë¹ˆ ì„¤ì • ë©”íƒ€ ì •ë³´ë¼ê³  í•œë‹¤.
    - @ bean, <bean > ë‹¹ ê°ê° í•˜ë‚˜ì˜ ë©”íƒ€ ì •ë³´ê°€ ìƒì„±ëœë‹¤.
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì´ ë©”íƒ€ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ìƒì„±í•œë‹¤.

ì •ë³´

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/cd4c5c0a-1563-4707-afa2-6b081ed69d45/55191b8a-1e29-47e4-9573-5c601a3c37cf/Untitled.png)

ì •ë¦¬

- springì€ BeanDefinitionì´ë¼ëŠ”ê±¸ë¡œ beanì˜ ì„¤ì • ë©”íƒ€ ì •ë³´ë¥¼ì¶”ìƒí™” í•œë‹¤.
- bean ì„ ë“±ë¡í•˜ëŠ”ë°©ë²•ì€ í¬ê²Œ ë‘ê°€ì§€ë‹¤
    - ì§ì ‘ë“±ë¡ - xml
    - factory bean ì´ìš© - java config
